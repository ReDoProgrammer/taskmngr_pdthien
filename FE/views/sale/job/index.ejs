<div class="row">
  <div class="offset-md-9 col-md-3 text-right">
    <!-- Another variation with a button -->
    <div class="input-group">
      <input type="text" class="form-control" placeholder="Seach any job" id="txtSearch" />
      <div class="input-group-btn">
        <button class="btn btn-info" type="submit" id="btnSearch">
          <i class="fa fa-search" aria-hidden="true"></i>
        </button>
      </div>
    </div>
  </div>
</div>
<div class="table-responsive">
  <table class="table mt-1 table-striped bg-white text-dark">
    <thead class="thead-dark">
      <tr>
        <th scope="col">#</th>
        <th scope="col">Customer</th>
        <th scope="col">Job name</th>
        <th scope="col">Receive date</th>
        <th scope="col">Delivery date</th>
        <th scope="col">Intruction</th>
        <th scope="col" class="text-center">Source link</th>
        <th scope="col" class="text-center">Product link</th>
        <th scope="col" class="text-right">Status</th>
      </tr>
    </thead>
    <tbody id="tblData">
    </tbody>
  </table>
</div>

<nav aria-label="..." class="mt-3">
  <ul class="pagination pagination-sm">
    <li class="page-item disabled">
      <a class="page-link" href="#" tabindex="-1">1</a>
    </li>
    <li class="page-item"><a class="page-link" href="#">2</a></li>
    <li class="page-item"><a class="page-link" href="#">3</a></li>
  </ul>
</nav>


<script type='text/javascript'
  src="https://rawgit.com/RobinHerbots/jquery.inputmask/3.x/dist/jquery.inputmask.bundle.js"></script>



<script>
  var search = "";
  var page = 1;

  $(document).ready(function () {
    LoadJobs();
  });


  $('#btnSearch').click(function () {
    search = $('#txtSearch').val();
    LoadJobs();
  })



  $('#txtSearch').keyup(function (e) {
    if (e.keyCode == 13) {
      $("#btnSearch").click()
    }
  });


  function LoadJobs() {
    $.ajax({
      url: "/sale/job/list",
      type: "get",
      headers: {
        authorization: "Bearer " + localStorage.getItem("accessToken"),
      },
      data: {
        search,
        page,
      },
      success: function (data) {
        $("#tblData").empty();
        // $("#pagination").empty();
        let idx = 1;
        data.jobs.forEach((job) => {
          let tr = "  <tr id='" + job._id + "' >";
          tr += '<th scope="row">' + idx++ + "</th>";
          tr +=
            " <td class='font-weight-bold'>" + job.customer.firstname + " " + job.customer.lastname + "</td>";
          tr += "<td class='text-info font-weight-bold'>" + job.name + "</td>";
          tr += "<td>" + new Date(job.received_date).toLocaleString() + "</td>";
          tr += "<td>" + new Date(job.delivery_date).toLocaleString() + "</td>";
          tr += "<td class='text-warning'>" + job.intruction + "</td>";
          tr += "<td class='font-italic font-weight-bold text-center'><a href='" + job.input_link + "' target='_blank'>Link</a></td>";
          tr += "<td class='font-italic font-weight-bold text-center'><a href='" + job.output_link + "' target='_blank'>Link</a></td>";


          tr += '<td class = "font-weight-bold text-right"><i>';
          switch (job.status) {
            case -1:
              tr += '<span class = "text-warning">Initial</span>';
              break;
            case 0:
              tr += '<span class = "text-info">Processing</span>';
              break;
            case 1:
              tr += '<span class = "text-primary">Upload</span>';
              break;
            case 2:
              tr += '<span class = "text-success">Done</span>';
              break;
            case -2:
              tr += '<span class = "text-danger">Rejected</span>';
              break;
            case -3:
              tr += '<span class = "text-muted">Canceled</span>';
              break;
          }
          tr += '</i></td>';

          $("#tblData").append(tr);
        });

        for (let i = 1; i <= data.pages; i++) {
          let li =
            '<li class="page-item"><a class="page-link" href="#">' +
            i +
            "</a></li>";
          $("#pagination").append(li);
        }
      },
      error: function (jqXHR, textStatus, errorThrown) {
        alert(jqXHR.responseJSON.msg + ". " + jqXHR.responseJSON.error);
      },
    });
  }


</script>