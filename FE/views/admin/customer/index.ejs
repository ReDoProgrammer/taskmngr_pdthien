<div class="row">
  <div class="col-md-2">
    <a href="/admin/customer/create" class="btn btn-dark">
      <span>
        <i class="fa fa-plus" aria-hidden="true"></i>
      </span>
      Add New
    </a>
  </div>

  <div class="offset-md-7 col-md-3 text-right">
    <!-- Another variation with a button -->
    <div class="input-group">
      <input type="text" class="form-control" placeholder="Search this blog" />
      <div class="input-group-append">
        <button class="btn btn-secondary" type="button">
          <i class="fa fa-search"></i>
        </button>
      </div>
    </div>
  </div>
</div>
<table class="table mt-1">
  <thead class="thead-dark">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Customer</th>
      <th scope="col">Phone</th>
      <th scope="col">Email</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody id="tblData"></tbody>
</table>

<nav aria-label="Page navigation example" class="mt-2">
  <ul class="pagination" id="pagination">    
    
  </ul>
</nav>

<%-include('modal')%> <%-include('style')%>

<script>
  var search = "";
  var page = 1;
  $(document).ready(() => {
    $("#direction").val("Quản lý khách hàng");
    LoadCustomer();
  });
  $("#btnAddNew").click(function () {
    $("#modalCustomer").modal();
  });
  $(".btnStyle").click(function () {
    $("#modalStyle").modal();
  });

  function LoadCustomer() {
    $.ajax({
      url: "/admin/customer/list",
      type: "get",
      headers: {
        authorization: "Bearer " + localStorage.getItem("accessToken"),
      },
      data: {
        search,
        page,
      },
      success: function (data, textStatus, xhr) {
        $('#tblData').empty();
        $('#pagination').empty();
        let idx = 1;
        data.result.forEach((customer) => {
          let tr = "  <tr>";
          tr += '<th scope="row">'+(idx++)+'</th>';
          tr += " <td>"+customer.firstname+" "+customer.lastname+"</td>";
          tr += "<td>"+customer.phone+"</td>";
          tr += "<td>"+customer.email+"</td>";

          tr += '<td class="text-right">';
          tr +=
            '  <a href="http://" target="_blank" rel="noopener noreferrer">';
          tr += '    <i class="fa fa-eye text-info" aria-hidden="true"></i>';
          tr += "  </a>";
          tr += ' <a href="http://" target="_blank" rel="noopener noreferrer">';
          tr +=
            ' <i class="fa fa-refresh text-warning" aria-hidden="true"></i>';
          tr += " </a>";
          tr += ' <a href="http://" target="_blank" rel="noopener noreferrer">';
          tr += '<i class="fa fa-trash text-danger" aria-hidden="true"></i>';
          tr += "</a>";
          tr += "  </td>";
          tr += "</tr>";
          $('#tblData').append(tr);
        });
        console.log(data.pages);
        for(let i = 1; i<=data.pages; i++){
          let li = '<li class="page-item"><a class="page-link" href="#">'+i+'</a></li>';
          $('#pagination').append(li);
        }
      },
      error: function (jqXHR, textStatus, errorThrown) {
        alert(jqXHR.responseJSON.msg + ". " + jqXHR.responseJSON.error);
      },
    });
  }
</script>
